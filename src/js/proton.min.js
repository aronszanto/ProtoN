var proton=function(){"use strict";const t={PrimNull:0,PrimString:1,PrimInt:2,PrimFloat:3,PrimBool:4,ConPair:5,ConList:6,ConObject:7},e=3,r=2147483647,n=4294967296;var i,s,o,u,f,l,h,a,p;return i=0,s=1,o=2,u=function(t){var e;do{e=(t%2?"1":"0")+(e||""),t>>=1}while(t);return e},f=function(t){return Number(t).toString(16)},l=function(t){return u(Math.abs(t)).length},h=function(t){return(1<<t)-1},a=function(t){return String.fromCharCode(t)},function(t){return String(t).charCodeAt(0)},p=function(){function t(t,e){var r,n;for(null==t&&(t=""),null==e&&(e=[]),this.buf=e.slice(),r=0,n=t.length;r<n;++r)this._bufwrite(t.charCodeAt(r))}t.displayName="BitString";var e=t.prototype;return e.buf=null,e._pos=-1,e._spill=0,e._spillen=0,e._peek=0,e._peeklen=0,e.size=function(){return this.buf.length+(this._spillen?1:0)},e.bitsize=function(){return 8*this.buf.length+this._spillen},e._bufwrite=function(t){return-1===this._pos?this.buf.push(t):(this.buf[this._pos]=t,++this._pos>=this.buf.length&&(this._pos=-1)),this},e.writebits=function(t,e){var r,n;for(e=e||l(t),r=this._spill<<e|t,e+=this._spillen;e>=8;)e-=8,n=r>>e,r&=h(e),this._bufwrite(n);return this._spill=r,this._spillen=e,this},e.flush=function(){var t;return t=this._spill,this._spillen&&(t<<=8-this._spillen,this._bufwrite(t)),this._spill=0,this._spillen=0,this},e.truncate=function(){return this.buf=[],this._pos=-1,this._spill=0,this._spillen=0,this._peek=0,this._peeklen=0,this},e._bufseek=function(t,e){var r;switch(null==e&&(e=i),e){case 1:r=this._pos+t;break;case 2:r=this.buf.length+t;break;default:r=t}return this._pos=r>=this.buf.length?-1:Math.max(0,r),this},e.seek=function(t,e){return null==e&&(e=i),this.flush(),this._peek=0,this._peeklen=0,this._bufseek(t,e),this},e.tell=function(){return-1===this._pos?this.buf.length:this._pos},e._nextbyte=function(){var t;return-1===this._pos?null:(t=this.buf[this._pos++],this._pos>=this.buf.length&&(this._pos=-1),t)},e.readbits=function(t){var e,r,n;if(0==t)return 0;for(e=this._peeklen,r=this._peek;e<t&&null!=(n=this._nextbyte());)e+=8,r=r<<8|n;return e>t?(this._peeklen=e-t,this._peek=r&h(this._peeklen),r>>=this._peeklen):(this._peeklen=0,this._peek=0),e?r:null},e.peek=function(t){var e,r,n,i,s;for(e=0,r=this._peeklen,n=this._peek,s=this._pos;r<t&&null!=(i=this._nextbyte());)e+=1,r+=8,n=n<<8|i;return 0==r?null:(r>t&&(n>>=r-t),e&&this._bufseek(s),n)},e.hasMore=function(){return null!=this.peek(1)},e.each=function(t,e){return null==e&&(e=this),this.buf.forEach(t,e),this},e.map=function(t,e){return null==e&&(e=this),this.buf.map(t,e)},e.reduce=function(t,e,r){return null==r&&(r=this),t=t.bind(this),this.buf.reduce(t,e)},e.bytearray=function(){return this.flush().buf.slice()},e.bin=function(t){return null==t&&(t=""),this.flush().buf.map(u).join(t)},e.hex=function(){return this.flush().buf.map(f).join("")},e.number=function(){return this.flush(),this.reduce(function(t,e){return t<<8|e})},e.dump=function(){return this.buf.map(a).join("")+(this._spillen?a(this._spill<<8-this._spillen):"")},e.repr=function(t){return null==t&&(t=!0),"BitString("+(t?"buf="+this.dump():"len(buf)="+this.buf.length)+", spill["+this._spillen+"]="+u(this._spill)+", tell="+this.tell()+", peek["+this._peeklen+"]="+u(this._peek)+")"},e.toString=function(){return this.flush().dump()},t}(),p.SEEK_ABSOLUTE=i,p.SEEK_RELATIVE=s,p.SEEK_FROM_EOF=o,{encode:function(i){function s(i,o){function u(t,e){var r=unescape(encodeURIComponent(t));e.writebits(r.length,16);for(var n=0;n<r.length;n++)e.writebits(r.charCodeAt(n),8);return e}if(null===i||void 0===i)return o.writebits(t.PrimNull,e);if("string"==typeof i)return o.writebits(t.PrimString,e),u(i,o);if("boolean"==typeof i)return o.writebits(t.PrimBool,e),o.writebits(i?1:0,1);if(Number.isInteger(i)){if(o.writebits(t.PrimInt,e),Math.abs(i)<r){o.writebits(0,1);var f=new DataView(new ArrayBuffer(4));f.setInt32(0,i,!1);for(var l=0;l<4;l+=2)o.writebits(f.getUint16(l,!1),16)}else{o.writebits(1,1);for(var h=4294967295&i,a=(i-h)/n,p=[a>>>16,65535&a,h>>>16,65535&h],l=0;l<p.length;l++)o.writebits(p[l],16)}return o}if("number"==typeof i){o.writebits(t.PrimFloat,e);var f=new DataView(new ArrayBuffer(8));f.setFloat64(0,i,!1);for(var l=0;l<8;l+=2)o.writebits(f.getUint16(l,!1),16);return o}if("[object Array]"===Object.prototype.toString.call(i)){o.writebits(t.ConList,e),o.writebits(i.length,16);for(var l=0;l<i.length;l++)o=s(i[l],o);return o}if(i===Object(i))return o.writebits(t.ConObject,e),o.writebits(Object.keys(i).length,16),Object.keys(i).forEach(function(r){o.writebits(t.ConPair,e),o=u(r,o),o=s(i[r],o)}),o;throw new Error("Error encoding object into ProtoN.")}if("[object Array]"!==Object.prototype.toString.call(i)&&i!==Object(i))throw new TypeError("ProtoN Encoding Requires a List or Object.");var o=new p;o.writebits(1,2);var u=s(i,o);return new Uint8Array(u.bytearray())},decode:function(r){function i(){throw new Error("Malformed ProtoN message.")}function s(t){return t.readbits(e)}function o(t){return t.readbits(16)}function u(t){for(var e=o(t),r="",n=0;n<e;n++)r+=String.fromCharCode(t.readbits(8));return decodeURIComponent(escape(r))}function f(r){var n=r.peek(e);return n==t.ConList||n==t.ConObject}function l(r){var s=r.readbits(e);if(s==t.PrimNull)return null;if(s==t.PrimString)return u(r);if(s==t.PrimInt){if(r.readbits(1)){for(var o=new DataView(new ArrayBuffer(8)),f=0;f<4;f++)o.setUint16(2*f,r.readbits(16),!1);var l=o.getInt32(0,!1);if(l>1048575)return 1/0;var h=o.getInt32(4,!1);return l|=0,l?l*n+h:h}for(var o=new DataView(new ArrayBuffer(4)),f=0;f<2;f++)o.setUint16(2*f,r.readbits(16),!1);return o.getInt32(0,!1)}if(s==t.PrimFloat){for(var o=new DataView(new ArrayBuffer(8)),f=0;f<4;f++)o.setUint16(2*f,r.readbits(16),!1);return o.getFloat64(0,!1)}if(s==t.PrimBool)return!!r.readbits(1);i()}function h(r){var n=s(r);if(n==t.ConList){for(var a=o(r),p=[],c=0;c<a;c++)f(r)?p.push(h(r)):p.push(l(r));return p}if(n==t.ConObject){for(var b=o(r),_={},c=0;c<b;c++){r.readbits(e)!=t.ConPair&&i();var w=u(r);f(r)?_[w]=h(r):_[w]=l(r)}return _}i()}if(!(r instanceof Uint8Array))throw new TypeError("proton.decode argument must be Uint8Array");var a=new p("",r);if(a.seek(0),1!=a.readbits(2))throw new Error("Unsupported ProtoN version.");return h(a)},get:function(t,e,r){var n=new XMLHttpRequest;t+="?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&"),n.open("GET",t),n.responseType="arraybuffer",n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE&&r){var t=null,e=n.response;if(e){var i=new Uint8Array(e);t=proton.decode(i)}r(t)}},n.send(e)},post:function(t,e,r){var n=proton.encode(e),i=new XMLHttpRequest;i.open("POST",t),i.setRequestHeader("Content-Type","proton"),i.responseType="arraybuffer",i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE&&r){var t=null,e=i.response;if(e){var n=new Uint8Array(e);t=proton.decode(n)}r(t)}},i.send(n)}}}();