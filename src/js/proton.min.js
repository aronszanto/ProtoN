var proton=function(){"use strict";const t={PrimNull:0,PrimString:1,PrimInt:2,PrimFloat:3,PrimBool:4,ConPair:5,ConList:6,ConObject:7},e=3,i=2147483647,r=4294967296;var n,s,u,o,l,h,f,a,b;return n=0,s=1,u=2,o=function(t){var e;do{e=(t%2?"1":"0")+(e||""),t>>=1}while(t);return e},l=function(t){return Number(t).toString(16)},h=function(t){return o(Math.abs(t)).length},f=function(t){return(1<<t)-1},a=function(t){return String.fromCharCode(t)},function(t){return String(t).charCodeAt(0)},b=function(){function t(t,e){var i,r;for(null==t&&(t=""),null==e&&(e=[]),this.buf=e.slice(),i=0,r=t.length;i<r;++i)this._bufwrite(t.charCodeAt(i))}t.displayName="BitString";var e=t.prototype;return e.buf=null,e._pos=-1,e._spill=0,e._spillen=0,e._peek=0,e._peeklen=0,e.size=function(){return this.buf.length+(this._spillen?1:0)},e.bitsize=function(){return 8*this.buf.length+this._spillen},e._bufwrite=function(t){return-1===this._pos?this.buf.push(t):(this.buf[this._pos]=t,++this._pos>=this.buf.length&&(this._pos=-1)),this},e.writebits=function(t,e){var i,r;for(e=e||h(t),i=this._spill<<e|t,e+=this._spillen;e>=8;)e-=8,r=i>>e,i&=f(e),this._bufwrite(r);return this._spill=i,this._spillen=e,this},e.flush=function(){var t;return t=this._spill,this._spillen&&(t<<=8-this._spillen,this._bufwrite(t)),this._spill=0,this._spillen=0,this},e.truncate=function(){return this.buf=[],this._pos=-1,this._spill=0,this._spillen=0,this._peek=0,this._peeklen=0,this},e._bufseek=function(t,e){var i;switch(null==e&&(e=n),e){case 1:i=this._pos+t;break;case 2:i=this.buf.length+t;break;default:i=t}return this._pos=i>=this.buf.length?-1:Math.max(0,i),this},e.seek=function(t,e){return null==e&&(e=n),this.flush(),this._peek=0,this._peeklen=0,this._bufseek(t,e),this},e.tell=function(){return-1===this._pos?this.buf.length:this._pos},e._nextbyte=function(){var t;return-1===this._pos?null:(t=this.buf[this._pos++],this._pos>=this.buf.length&&(this._pos=-1),t)},e.readbits=function(t){var e,i,r;if(0==t)return 0;for(e=this._peeklen,i=this._peek;e<t&&null!=(r=this._nextbyte());)e+=8,i=i<<8|r;return e>t?(this._peeklen=e-t,this._peek=i&f(this._peeklen),i>>=this._peeklen):(this._peeklen=0,this._peek=0),e?i:null},e.peek=function(t){var e,i,r,n,s;for(e=0,i=this._peeklen,r=this._peek,s=this._pos;i<t&&null!=(n=this._nextbyte());)e+=1,i+=8,r=r<<8|n;return 0==i?null:(i>t&&(r>>=i-t),e&&this._bufseek(s),r)},e.hasMore=function(){return null!=this.peek(1)},e.each=function(t,e){return null==e&&(e=this),this.buf.forEach(t,e),this},e.map=function(t,e){return null==e&&(e=this),this.buf.map(t,e)},e.reduce=function(t,e,i){return null==i&&(i=this),t=t.bind(this),this.buf.reduce(t,e)},e.bytearray=function(){return this.flush().buf.slice()},e.bin=function(t){return null==t&&(t=""),this.flush().buf.map(o).join(t)},e.hex=function(){return this.flush().buf.map(l).join("")},e.number=function(){return this.flush(),this.reduce(function(t,e){return t<<8|e})},e.dump=function(){return this.buf.map(a).join("")+(this._spillen?a(this._spill<<8-this._spillen):"")},e.repr=function(t){return null==t&&(t=!0),"BitString("+(t?"buf="+this.dump():"len(buf)="+this.buf.length)+", spill["+this._spillen+"]="+o(this._spill)+", tell="+this.tell()+", peek["+this._peeklen+"]="+o(this._peek)+")"},e.toString=function(){return this.flush().dump()},t}(),b.SEEK_ABSOLUTE=n,b.SEEK_RELATIVE=s,b.SEEK_FROM_EOF=u,{encode:function(n){function s(n,u){function o(t,e){var i=unescape(encodeURIComponent(t));e.writebits(i.length,16);for(var r=0;r<i.length;r++)e.writebits(i.charCodeAt(r),8);return e}if(null===n||void 0===n)return u.writebits(t.PrimNull,e);if("string"==typeof n)return u.writebits(t.PrimString,e),o(n,u);if("boolean"==typeof n)return u.writebits(t.PrimBool,e),u.writebits(n?1:0,1);if(Number.isInteger(n)){if(u.writebits(t.PrimInt,e),Math.abs(n)<i){u.writebits(0,1);var l=new DataView(new ArrayBuffer(4));l.setInt32(0,n,!1);for(var h=0;h<4;h+=2)u.writebits(l.getUint16(h,!1),16)}else{u.writebits(1,1);for(var f=4294967295&n,a=(n-f)/r,b=[a>>>16,65535&a,f>>>16,65535&f],h=0;h<b.length;h++)u.writebits(b[h],16)}return u}if("number"==typeof n){u.writebits(t.PrimFloat,e);var l=new DataView(new ArrayBuffer(8));l.setFloat64(0,n,!1);for(var h=0;h<8;h+=2)u.writebits(l.getUint16(h,!1),16);return u}if("[object Array]"===Object.prototype.toString.call(n)){u.writebits(t.ConList,e),u.writebits(n.length,16);for(var h=0;h<n.length;h++)u=s(n[h],u);return u}if(n===Object(n))return u.writebits(t.ConObject,e),u.writebits(Object.keys(n).length,16),Object.keys(n).forEach(function(i){u.writebits(t.ConPair,e),u=o(i,u),u=s(n[i],u)}),u;throw new Error("Error encoding object into ProtoN.")}if("[object Array]"!==Object.prototype.toString.call(n)&&n!==Object(n))throw new TypeError("ProtoN Encoding Requires a List or Object.");var u=new b;return u.writebits(1,2),s(n,u).toString()},decode:function(i){function n(){throw new Error("Malformed ProtoN message.")}function s(t){return t.readbits(e)}function u(t){return t.readbits(16)}function o(t){for(var e=u(t),i="",r=0;r<e;r++)i+=String.fromCharCode(t.readbits(8));return decodeURIComponent(escape(i))}function l(i){var r=i.peek(e);return r==t.ConList||r==t.ConObject}function h(i){var s=i.readbits(e);if(s==t.PrimNull)return null;if(s==t.PrimString)return o(i);if(s==t.PrimInt){if(!!i.readbits(1)){for(var u=new DataView(new ArrayBuffer(8)),l=0;l<4;l++)u.setUint16(2*l,i.readbits(16),!1);var h=u.getInt32(0,!1);if(h>1048575)return 1/0;var f=u.getInt32(4,!1);return h|=0,h?h*r+f:f}for(var u=new DataView(new ArrayBuffer(4)),l=0;l<2;l++)u.setUint16(2*l,i.readbits(16),!1);return u.getInt32(0,!1)}if(s==t.PrimFloat){for(var u=new DataView(new ArrayBuffer(8)),l=0;l<4;l++)u.setUint16(2*l,i.readbits(16),!1);return u.getFloat64(0,!1)}if(s==t.PrimBool)return!!i.readbits(1);n()}function f(i){var r=s(i);if(r==t.ConList){for(var a=u(i),b=[],p=0;p<a;p++)l(i)?b.push(f(i)):b.push(h(i));return b}if(r==t.ConObject){for(var c=u(i),_={},p=0;p<c;p++){i.readbits(e)!=t.ConPair&&n();var w=o(i);l(i)?_[w]=f(i):_[w]=h(i)}return _}n()}var a=new b(i);if(a.seek(0),1!=a.readbits(2))throw new Error("Unsupported ProtoN version.");return f(a)}}}();